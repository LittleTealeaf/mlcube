generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["views"]
}

datasource db {
  provider = "sqlserver"
  url      = env("DATABASE_URL")
}

model Epoch {
  EpochId Int    @id(map: "PK__Epochs__97971E396A8F4803") @default(autoincrement())
  ModelId Int
  Epoch   Int
  Loss    Float?
  Reward  Float?
  Model   Model  @relation(fields: [ModelId], references: [ModelId], onUpdate: NoAction, map: "FK__Epochs__ModelId__49C3F6B7")
}

model Evaluation {
  EvaluationId   Int              @id(map: "PK__Evaluati__36AE68F3C5CFD38C") @default(autoincrement())
  ModelId        Int
  Epoch          Int
  Solved         Boolean?
  MoveCount      Int?
  Seed           BigInt?
  Model          Model            @relation(fields: [ModelId], references: [ModelId], onUpdate: NoAction, map: "FK__Evaluatio__Model__4CA06362")
  EvaluationMove EvaluationMove[]
}

model EvaluationMove {
  EvaluationMoveId Int         @id(map: "PK__Evaluati__772CA240D89BB96E") @default(autoincrement())
  EvaluationId     Int?
  MoveIndex        Int?
  MoveName         String?     @db.VarChar(10)
  Reward           Float?
  Evaluation       Evaluation? @relation(fields: [EvaluationId], references: [EvaluationId], onDelete: NoAction, onUpdate: NoAction, map: "FK__Evaluatio__Evalu__4F7CD00D")
}

model Model {
  ModelId    Int          @id(map: "PK__Models__E8D7A12C80EFBE84") @default(autoincrement())
  ModelName  String?      @db.VarChar(100)
  GitHash    String?      @db.VarChar(40)
  CubeType   String?      @db.VarChar(50)
  Epoch      Epoch[]
  Evaluation Evaluation[]
}

view ModelInfo {
  ModelId    Int     @unique
  ModelName  String? @db.VarChar(100)
  GitHash    String? @db.VarChar(40)
  CubeType   String? @db.VarChar(50)
  EpochCount Int?
}

view GroupedEpoch {
  GroupedId  BigInt @unique
  EpochGroup Int?
  ModelId    Int
  AvgLoss    Float?
  AvgReward  Float?
}

view EvaluationInfo {
  EvaluationId Int      @unique
  ModelId      Int
  Epoch        Int
  Seed         BigInt?
  Solved       Boolean?
  AvgReward    Float?
  MaxReward    Float?
  MinReward    Float?
  FinalReward  Float?
  MoveCount    Int?
}
